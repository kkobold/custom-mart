===== Config file =====
[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 3000
max_z_velocity = 5
max_z_accel = 100

[mcu]
serial = /dev/serial/by-id/usb-Klipper_stm32g0b1xx_26001E0001504B5735313920-if00
restart_method = command

[temperature_sensor SKR Mini]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[force_move]
enable_force_move = True

[exclude_object]

[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[mcu pi]
serial = /tmp/klipper_host_mcu

[temperature_sensor Pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[output_pin beeper]
pin = pi:gpiochip1/gpio118
value = 0
shutdown_value = 0
pwm = True
cycle_time = 0.0005

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
position_endstop = -17
position_max = 235
homing_speed = 40
endstop_pin = tmc2209_stepper_x:virtual_endstop
homing_retract_dist = 0
position_min = -17

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
diag_pin = PC0
driver_sgthrs = 80
interpolate = False
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
position_endstop = -23
position_max = 227
position_min = -26
homing_speed = 40
endstop_pin = tmc2209_stepper_y:virtual_endstop
homing_retract_dist = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.580
interpolate = False
stealthchop_threshold = 999999
diag_pin = PC1
driver_sgthrs = 80

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 235
position_min = -8

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
interpolate = False
stealthchop_threshold = 999999

[heater_bed]
heater_pin = pi:gpio3
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
control = pid
pid_kp = 70.901
pid_ki = 1.320
pid_kd = 951.845
min_temp = 0
max_temp = 130

[probe]
pin = PC2
x_offset = 40
y_offset = 18
speed = 5.0
lift_speed = 15.0
sample_retract_dist = 1
samples = 2
samples_tolerance_retries = 6
z_offset = 7.589

[screws_tilt_adjust]
screw1 = 10,-14
screw1_name = front left screw
screw2 = 10, 157
screw2_name = rear left screw
screw3 = 182, 157
screw3_name = rear right screw
screw4 = 182, -14
screw4_name = front right screw
screw_thread = CW-M4
horizontal_move_z = 9

[bed_mesh]
speed = 300
horizontal_move_z = 9
mesh_min = 10,-14
mesh_max = 167,167
probe_count = 5,5
zero_reference_position = 117.5, 117.5
algorithm = bicubic
fade_start = 1
fade_end = 10
split_delta_z = 0.015
move_check_distance = 3
mesh_pps = 4,4

[homing_override]
set_position_z = 0
gcode = 
	{% set PO = (params.PO|default(1)) %}
	{% set PI = (params.PI|default(1)) %}
	
	STATUS_HOMING
	G90
	G1 Z10 F3000
	G28 X
	G28 Y
	{% if PO == 1 %}
	PROBE_OUT
	{% endif %}
	G90
	G1 X99 Y77 F6000
	G28 Z
	G1 Z15
	
	
	
	
	
	
	{% if PI == 1 %}
	PROBE_IN
	{% endif %}
	STATUS_READY

[gcode_macro PROBE_OUT]
gcode = 
	G90
	G1 X228 F4000
	G4 P300
	G1 Z20
	G1 X0

[gcode_macro PROBE_IN]
gcode = 
	G90
	G1 Z20
	G1 X228 F20000
	G1 Y-8
	G1 Z5
	G4 P300
	G1 X220 F6000
	G1 Z15
	G1 X0

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro G29]
gcode = 
	PROBE_OUT
	BED_MESH_CALIBRATE
	
	PROBE_IN

[gcode_macro PROBE_CALIBRATE]
rename_existing = _PROBE_CALIBRATE
gcode = 
	{% if not 'xyz' in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	PROBE_OUT
	G90
	G1 Z20
	G1 X115 Y115 F20000
	_PROBE_CALIBRATE
	TESTZ Z=20
	M117 Remove the Klack to continue calibration!

[gcode_macro PROBE_ACCURACY]
rename_existing = _PROBE_ACCURACY
gcode = 
	{% if not 'xyz' in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	PROBE_OUT
	G90
	G1 Y115 X115 F20000
	_PROBE_ACCURACY
	PROBE_IN

[gcode_macro SCREWS_TILT_CALCULATE]
rename_existing = _SCREWS_TILT_CALCULATE
gcode = 
	{% set PO = (params.PO|default(1)) %}
	{% set PI = (params.PI|default(1)) %}
	{% if PO == 1 %}
	PROBE_OUT
	{% endif %}
	_SCREWS_TILT_CALCULATE
	{% if PI == 1 %}
	PROBE_IN
	{% endif %}
	G1 X117.5 Y220 Z20 F25000
	BEEP DUR=1000

[extruder]
max_extrude_only_distance = 750
step_pin = PB3
dir_pin = PB4
enable_pin = !PD1
gear_ratio = 50:10
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 22.6789511
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = pi:gpio2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA0
pressure_advance = 0.418
min_temp = 0
max_temp = 300
min_extrude_temp = 0
control = pid
pid_kp = 38.039
pid_ki = 4.528
pid_kd = 79.882

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
interpolate = False
stealthchop_threshold = 0
run_current = 0.54
hold_current = 0.44

[neopixel sb_leds]
pin = PA8
chain_count = 10
color_order = GRB, GRB, GRB, GRB, GRB, GRB, GRB, GRB, GRBW,  GRBW
initial_red = 1.0
initial_green = 0.0
initial_blue = 1.0
initial_white = 0.0

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:sb_leds
autostart = true
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set allow_park = client.park_at_cancel | default(false) | lower == 'true' %}
	{% set retract = client.cancel_retract | default(5.0) | abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x | default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y | default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x | length > 0 or park_y | length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro | default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set idle_timeout = client.idle_timeout | default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE | default(1) | int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro | default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move | default(velocity) %}
	{% set runout_resume = True if client.runout_sensor | default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state | upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro | default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY | default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE | default(1)|int != 0 %}
	{% set MACRO = params.MACRO | default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE | int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER | default(pause_at_layer.layer) | int %}
	{% set MACRO = params.MACRO | default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER | int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos | default(false) | lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x | default(0.0) %}
	{% set custom_park_y  = client.custom_park_y | default(0.0) %}
	{% set park_dz        = client.custom_park_dz | default(2.0) | abs %}
	{% set sp_hop         = client.speed_hop | default(15) * 60 %}
	{% set sp_move        = client.speed_move | default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z | default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN | default(0) | float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)] | min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set use_fw_retract = (client.use_fw_retract | default(false) | lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH | default(client.unretract) | default(1.0) | float %}
	{% set speed = params.SPEED | default(client.speed_unretract) | default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed | float | abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set length = params.LENGTH | default(client.retract) | default(1.0) | float %}
	{% set speed = params.SPEED | default(client.speed_retract) | default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length | float | abs} SPEED={speed | float | abs}

[gcode_macro LINE_PURGE]
description = A purge macro that adapts to be near your actual printed objects
gcode = 
	
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	{% set cross_section = printer.configfile.settings.extruder.max_extrude_cross_section | float %}
	
	
	{% if printer.firmware_retraction is defined %}
	{% set RETRACT = G10 | string %}
	{% set UNRETRACT = G11 | string %}
	{% else %}
	{% set RETRACT = 'G1 E-.5 F2100' | string %}
	{% set UNRETRACT = 'G1 E.5 F2100' | string %}
	{% endif %}
	
	
	{% set verbose_enable = printer["gcode_macro _KAMP_Settings"].verbose_enable | abs %}
	{% set purge_height = printer["gcode_macro _KAMP_Settings"].purge_height | float %}
	{% set tip_distance = printer["gcode_macro _KAMP_Settings"].tip_distance | float %}
	{% set purge_margin = printer["gcode_macro _KAMP_Settings"].purge_margin | float %}
	{% set purge_amount = printer["gcode_macro _KAMP_Settings"].purge_amount | float %}
	{% set flow_rate = printer["gcode_macro _KAMP_Settings"].flow_rate | float %}
	
	
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set purge_x_min = (all_points | map(attribute=0) | min | default(0)) %}
	{% set purge_x_max = (all_points | map(attribute=0) | max | default(0)) %}
	{% set purge_y_min = (all_points | map(attribute=1) | min | default(0)) %}
	{% set purge_y_max = (all_points | map(attribute=1) | max | default(0)) %}
	
	{% set purge_x_center = ([((purge_x_max + purge_x_min) / 2) - (purge_amount / 2), 0] | max) %}
	{% set purge_y_center = ([((purge_y_max + purge_y_min) / 2) - (purge_amount / 2), 0] | max) %}
	
	{% set purge_x_origin = ([purge_x_min - purge_margin, 0] | max) %}
	{% set purge_y_origin = ([purge_y_min - purge_margin, 0] | max) %}
	
	
	{% set purge_move_speed = (flow_rate / 5.0) * 60 | float %}
	
	{% if cross_section < 5 %}
	
	{action_respond_info("[Extruder] max_extrude_cross_section is insufficient for purge, please set it to 5 or greater. Purge skipped.")}
	
	{% else %}
	
	{% if verbose_enable == True %}
	
	{action_respond_info("Moving filament tip {}mms".format(
	(tip_distance),
	)) }
	{% endif %}
	
	{% if printer.firmware_retraction is defined %}
	{action_respond_info("KAMP purge is using firmware retraction.")}
	{% else %}
	{action_respond_info("KAMP purge is not using firmware retraction, it is recommended to configure it.")}
	{% endif %}
	
	{% if purge_y_origin > 0 %}
	
	{action_respond_info("KAMP purge starting at {}, {} and purging {}mm of filament, requested flow rate is {}mm3/s.".format(
	(purge_x_center),
	(purge_y_origin),
	(purge_amount),
	(flow_rate),
	)) }
	
	{% else %}
	
	{action_respond_info("KAMP purge starting at {}, {} and purging {}mm of filament, requested flow rate is {}mm3/s.".format(
	(purge_x_origin),
	(purge_y_center),
	(purge_amount),
	(flow_rate),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Prepurge_State
	
	{% if purge_y_origin > 0 %}
	
	G92 E0
	G0 F{travel_speed}
	G90
	G0 X{purge_x_center} Y{purge_y_origin}
	G0 Z{purge_height}
	M83
	G1 E{tip_distance} F{purge_move_speed}
	G1 X{purge_x_center + purge_amount} E{purge_amount} F{purge_move_speed}
	{RETRACT}
	G0 X{purge_x_center + purge_amount + 10} F{travel_speed}
	G92 E0
	M82
	G0 Z{purge_height * 2} F{travel_speed}
	
	{% else %}
	
	G92 E0
	G0 F{travel_speed}
	G90
	G0 X{purge_x_origin} Y{purge_y_center}
	G0 Z{purge_height}
	M83
	G1 E{tip_distance} F{purge_move_speed}
	G1 Y{purge_y_center + purge_amount} E{purge_amount} F{purge_move_speed}
	{RETRACT}
	G0 Y{purge_y_center + purge_amount + 10} F{travel_speed}
	G92 E0
	M82
	G0 Z{purge_height * 2} F{travel_speed}
	
	{% endif %}
	
	RESTORE_GCODE_STATE NAME=Prepurge_State
	
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = True
variable_attach_macro = 'PROBE_OUT'
variable_detach_macro = 'PROBE_IN'
variable_purge_height = 0.3
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 5
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[gcode_macro PRINT_START]
gcode = 
	
	{% set target_bed = params.BED|int %}
	{% set target_extruder = params.EXTRUDER|int %}
	{% set target_chamber = params.CHAMBER|default("40")|int %}
	{% set x_wait = printer.toolhead.axis_maximum.x|float / 2 %}
	{% set y_wait = printer.toolhead.axis_maximum.y|float / 2 %}
	
	
	SET_DISPLAY_TEXT MSG="Homing..."
	M140 S{target_bed}
	M104 S{target_extruder}
	M300
	STATUS_HOMING
	_CG28
	G90
	
	
	BED_MESH_CLEAR
	
	
	
	SET_DISPLAY_TEXT MSG="Bed: {target_bed}c"
	STATUS_HEATING
	M106 S255
	
	
	
	
	G1 X{x_wait} Y{y_wait} Z15 F9000
	M300
	M300
	M190 S{target_bed}
	M300
	M300
	M300
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	SET_DISPLAY_TEXT MSG="Bed mesh"
	STATUS_MESHING
	bed_mesh_calibrate
	M300
	M300
	M300
	M300
	
	
	SET_DISPLAY_TEXT MSG="Hotend: {target_extruder}c"
	STATUS_HEATING
	G1 X{x_wait} Y{y_wait} Z15 F9000
	M107
	M109 S{target_extruder}
	
	SET_DISPLAY_TEXT MSG="Printing Prime Line"
	PRIME_LINE
	
	SET_DISPLAY_TEXT MSG="Printer goes brr"
	STATUS_PRINTING
	M300
	M300
	M300
	M300
	M300
	G0 X{x_wait - 50} Y4 F10000
	G0 Z0.4
	G91
	G1 X100 E20 F1000
	G90

[gcode_macro END_PRINT]
gcode = 
	
	SET_DISPLAY_TEXT MSG="Work Complete!"
	STATUS_PART_READY
	M140 S0
	M104 S0
	M106 S0
	G91
	G1 Z25 F3000
	G1 X10 Y200
	G90
	M84
	M300
	M300
	M300
	M300
	M300
	M300

[gcode_macro PRIME_LINE]
gcode = 
	STATUS_CLEANING
	G92 E0
	G1 X3.1 Y10 Z0.2 F5000.0
	G1 X3.1 Y200.0 Z0.2 F3000.0 E15
	G1 X3.5 Y200.0 Z0.2 F5000.0
	G1 X3.5 Y10 Z0.2 F3000.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 E-2 F300

[gcode_macro _CG28]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}

[gcode_macro M109]
rename_existing = M99109
gcode = 
	
	{% set s = params.S|float %}
	
	M104 {% for p in params %}{'%s%s' % (p, params[p])}{% endfor %}
	{% if s != 0 %}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={s} MAXIMUM={s+1}
	{% endif %}

[gcode_macro M190]
rename_existing = M99190
gcode = 
	
	{% set s = params.S|float %}
	
	M140 {% for p in params %}{'%s%s' % (p, params[p])}{% endfor %}
	{% if s != 0 %}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={s} MAXIMUM={s+1}
	{% endif %}

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(2)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GANTRY_ALIGN]
gcode = 
	G28 PI=0
	G1 Z225
	M84
	G28 PO=0 PI=0
	Z_TILT_ADJUST PO=0 PI=0
	SCREWS_TILT_CALCULATE PO=0

[gcode_macro BEEP]
gcode = 
	
	{% set i = params.I|default(1)|int %}
	{% set dur = params.DUR|default(100)|int %}
	{% set freq = params.FREQ|default(2000)|int %}
	
	{% for iteration in range(i|int) %}
	SET_PIN PIN=beeper VALUE=0.8 CYCLE_TIME={ 1.0/freq if freq > 0 else 1 }
	G4 P{dur}
	SET_PIN PIN=beeper VALUE=0
	G4 P{dur}
	{% endfor %}

[gcode_macro M300]
gcode = 
	BEEP dur=100
=======================
Loaded MCU 'mcu' 106 commands (v0.12.0-85-gd785b396 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1_PA9_PA10=PA9,PA10 BUS_PINS_i2c1_PB6_PB7=PB6,PB7 BUS_PINS_i2c1_PB8_PB9=PB8,PB9 BUS_PINS_i2c2_PB10_PB11=PB10,PB11 BUS_PINS_i2c2_PB13_PB14=PB13,PB14 BUS_PINS_i2c3_PB3_PB4=PB3,PB4 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=64000000 MCU=stm32g0b1xx PWM_MAX=255 RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PF0,PF1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Loaded MCU 'pi' 119 commands (v0.12.0-267-g12cd1d9e / gcc: (Debian 10.2.1-6) 10.2.1 20210110 binutils: (GNU Binutils for Debian) 2.35.2)
MCU 'pi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Configured MCU 'pi' (1024 moves)
Args: ['/home/kkobold/klipper/klippy/klippy.py', '/home/kkobold/printer_data/config/printer.cfg', '-I', '/home/kkobold/printer_data/comms/klippy.serial', '-l', '/home/kkobold/printer_data/logs/klippy.log', '-a', '/home/kkobold/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-267-g12cd1d9e-dirty'
Untracked files: klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.9.2 (default, Feb 28 2021, 17:03:44) \n[GCC 10.2.1 20210110]'
webhooks client 281472760906848: {'program': 'Moonraker', 'version': 'v0.8.0-385-gdc00d38'}
=============== Log rollover at Tue Aug  6 09:58:03 2024 ===============
Stats 20.5: gcodein=0  mcu: mcu_awake=0.055 mcu_task_avg=0.000042 mcu_task_stddev=0.000095 bytes_write=7331 bytes_read=8290 bytes_retransmit=9 bytes_invalid=0 send_seq=416 receive_seq=416 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63995349 pi: mcu_awake=0.005 mcu_task_avg=0.000030 mcu_task_stddev=0.000027 bytes_write=970 bytes_read=4758 bytes_retransmit=0 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000041 adj=49985876 Mini: temp=28.8  Pi: temp=50.5 heater_bed: target=0 temp=24.3 pwm=0.000 sysload=1.85 cputime=4.130 memavail=1738860 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 21.5: gcodein=0  mcu: mcu_awake=0.055 mcu_task_avg=0.000042 mcu_task_stddev=0.000095 bytes_write=8594 bytes_read=9026 bytes_retransmit=9 bytes_invalid=0 send_seq=473 receive_seq=473 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63996513 pi: mcu_awake=0.005 mcu_task_avg=0.000030 mcu_task_stddev=0.000027 bytes_write=976 bytes_read=4774 bytes_retransmit=0 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999920 adj=49992666 Mini: temp=29.0  Pi: temp=46.8 heater_bed: target=0 temp=24.3 pwm=0.000 sysload=1.85 cputime=4.213 memavail=1738868 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 22.5: gcodein=0  mcu: mcu_awake=0.055 mcu_task_avg=0.000042 mcu_task_stddev=0.000095 bytes_write=9807 bytes_read=9619 bytes_retransmit=9 bytes_invalid=0 send_seq=523 receive_seq=523 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998282 pi: mcu_awake=0.005 mcu_task_avg=0.000030 mcu_task_stddev=0.000027 bytes_write=982 bytes_read=4790 bytes_retransmit=0 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999624 adj=49992777 Mini: temp=29.0  Pi: temp=46.9 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=1.85 cputime=4.285 memavail=1737140 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 23.5: gcodein=0  mcu: mcu_awake=0.055 mcu_task_avg=0.000042 mcu_task_stddev=0.000095 bytes_write=10958 bytes_read=10181 bytes_retransmit=9 bytes_invalid=0 send_seq=570 receive_seq=570 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998862 pi: mcu_awake=0.005 mcu_task_avg=0.000030 mcu_task_stddev=0.000027 bytes_write=988 bytes_read=4806 bytes_retransmit=0 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999365 adj=49990569 Mini: temp=29.0  Pi: temp=45.2 heater_bed: target=0 temp=24.3 pwm=0.000 sysload=1.85 cputime=4.355 memavail=1720788 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 24.5: gcodein=0  mcu: mcu_awake=0.055 mcu_task_avg=0.000042 mcu_task_stddev=0.000095 bytes_write=12156 bytes_read=10862 bytes_retransmit=9 bytes_invalid=0 send_seq=616 receive_seq=616 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998456 pi: mcu_awake=0.005 mcu_task_avg=0.000030 mcu_task_stddev=0.000027 bytes_write=994 bytes_read=4822 bytes_retransmit=0 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999267 adj=49991038 Mini: temp=29.2  Pi: temp=47.4 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=1.85 cputime=4.452 memavail=1674212 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 25.6: gcodein=0  mcu: mcu_awake=0.066 mcu_task_avg=0.000071 mcu_task_stddev=0.000136 bytes_write=13326 bytes_read=11409 bytes_retransmit=9 bytes_invalid=0 send_seq=655 receive_seq=655 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998275 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1000 bytes_read=4851 bytes_retransmit=0 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999373 adj=49994071 Mini: temp=29.1  Pi: temp=58.6 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.34 cputime=4.548 memavail=1616068 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 26.6: gcodein=0  mcu: mcu_awake=0.066 mcu_task_avg=0.000071 mcu_task_stddev=0.000136 bytes_write=14442 bytes_read=11951 bytes_retransmit=9 bytes_invalid=0 send_seq=698 receive_seq=698 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998415 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1006 bytes_read=4867 bytes_retransmit=0 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999348 adj=49996525 Mini: temp=29.2  Pi: temp=52.5 heater_bed: target=0 temp=23.9 pwm=0.000 sysload=2.34 cputime=4.628 memavail=1634140 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 27.6: gcodein=0  mcu: mcu_awake=0.066 mcu_task_avg=0.000071 mcu_task_stddev=0.000136 bytes_write=15663 bytes_read=12655 bytes_retransmit=9 bytes_invalid=0 send_seq=747 receive_seq=747 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998092 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1012 bytes_read=4883 bytes_retransmit=0 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=50000076 adj=49997081 Mini: temp=29.2  Pi: temp=57.3 heater_bed: target=0 temp=24.5 pwm=0.000 sysload=2.34 cputime=4.729 memavail=1701804 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 28.6: gcodein=0  mcu: mcu_awake=0.066 mcu_task_avg=0.000071 mcu_task_stddev=0.000136 bytes_write=16903 bytes_read=13282 bytes_retransmit=9 bytes_invalid=0 send_seq=799 receive_seq=799 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997556 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1018 bytes_read=4899 bytes_retransmit=0 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999945 adj=50001716 Mini: temp=29.1  Pi: temp=55.7 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.34 cputime=4.831 memavail=1752216 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 29.6: gcodein=0  mcu: mcu_awake=0.066 mcu_task_avg=0.000071 mcu_task_stddev=0.000136 bytes_write=18048 bytes_read=13844 bytes_retransmit=9 bytes_invalid=0 send_seq=846 receive_seq=846 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997417 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1024 bytes_read=4915 bytes_retransmit=0 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999915 adj=50002885 Mini: temp=29.3  Pi: temp=54.6 heater_bed: target=0 temp=24.6 pwm=0.000 sysload=2.34 cputime=4.921 memavail=1755836 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 30.6: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000071 mcu_task_stddev=0.000137 bytes_write=19273 bytes_read=14524 bytes_retransmit=9 bytes_invalid=0 send_seq=898 receive_seq=898 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997460 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000013 bytes_write=1030 bytes_read=4944 bytes_retransmit=0 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999831 adj=50002971 Mini: temp=29.2  Pi: temp=44.4 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.24 cputime=4.997 memavail=1755348 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 31.6: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000071 mcu_task_stddev=0.000137 bytes_write=20474 bytes_read=15112 bytes_retransmit=9 bytes_invalid=0 send_seq=947 receive_seq=947 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997651 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000013 bytes_write=1036 bytes_read=4960 bytes_retransmit=0 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999711 adj=50002184 Mini: temp=29.5  Pi: temp=45.5 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.24 cputime=5.083 memavail=1708596 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 32.6: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000071 mcu_task_stddev=0.000137 bytes_write=21617 bytes_read=15654 bytes_retransmit=9 bytes_invalid=0 send_seq=990 receive_seq=990 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997611 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000013 bytes_write=1042 bytes_read=4976 bytes_retransmit=0 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999697 adj=50001004 Mini: temp=29.3  Pi: temp=51.7 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=2.24 cputime=5.161 memavail=1707660 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.3 pwm=0.000
Stats 33.6: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000071 mcu_task_stddev=0.000137 bytes_write=22811 bytes_read=16278 bytes_retransmit=9 bytes_invalid=0 send_seq=1039 receive_seq=1039 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997502 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000013 bytes_write=1048 bytes_read=4992 bytes_retransmit=0 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999649 adj=50001226 Mini: temp=29.7  Pi: temp=49.2 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.24 cputime=5.230 memavail=1719976 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.6 pwm=0.000
Stats 34.6: gcodein=0  mcu: mcu_awake=0.065 mcu_task_avg=0.000071 mcu_task_stddev=0.000137 bytes_write=24004 bytes_read=16853 bytes_retransmit=9 bytes_invalid=0 send_seq=1087 receive_seq=1087 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63997944 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000013 bytes_write=1054 bytes_read=5008 bytes_retransmit=0 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999614 adj=50001510 Mini: temp=29.7  Pi: temp=52.2 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=2.24 cputime=5.330 memavail=1719116 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.3 pwm=0.000
Stats 35.6: gcodein=0  mcu: mcu_awake=0.062 mcu_task_avg=0.000068 mcu_task_stddev=0.000136 bytes_write=25192 bytes_read=17432 bytes_retransmit=9 bytes_invalid=0 send_seq=1134 receive_seq=1134 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=63998260 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000007 bytes_write=1060 bytes_read=5037 bytes_retransmit=0 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999592 adj=49999493 Mini: temp=29.6  Pi: temp=45.2 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.22 cputime=5.392 memavail=1709596 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 36.6: gcodein=0  mcu: mcu_awake=0.062 mcu_task_avg=0.000068 mcu_task_stddev=0.000136 bytes_write=26355 bytes_read=18051 bytes_retransmit=9 bytes_invalid=0 send_seq=1182 receive_seq=1182 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998468 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000007 bytes_write=1066 bytes_read=5053 bytes_retransmit=0 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999568 adj=49998431 Mini: temp=29.9  Pi: temp=51.6 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.22 cputime=5.451 memavail=1742656 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 37.6: gcodein=0  mcu: mcu_awake=0.062 mcu_task_avg=0.000068 mcu_task_stddev=0.000136 bytes_write=27554 bytes_read=18626 bytes_retransmit=9 bytes_invalid=0 send_seq=1230 receive_seq=1230 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998405 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000007 bytes_write=1072 bytes_read=5069 bytes_retransmit=0 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999549 adj=49997991 Mini: temp=29.9  Pi: temp=47.2 heater_bed: target=0 temp=23.9 pwm=0.000 sysload=2.22 cputime=5.509 memavail=1737240 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 38.6: gcodein=0  mcu: mcu_awake=0.062 mcu_task_avg=0.000068 mcu_task_stddev=0.000136 bytes_write=28760 bytes_read=19201 bytes_retransmit=9 bytes_invalid=0 send_seq=1278 receive_seq=1278 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998336 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000007 bytes_write=1078 bytes_read=5085 bytes_retransmit=0 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999560 adj=49998862 Mini: temp=29.7  Pi: temp=49.6 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.22 cputime=5.592 memavail=1739260 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 39.6: gcodein=0  mcu: mcu_awake=0.062 mcu_task_avg=0.000068 mcu_task_stddev=0.000136 bytes_write=29911 bytes_read=19807 bytes_retransmit=9 bytes_invalid=0 send_seq=1325 receive_seq=1325 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998282 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000007 bytes_write=1084 bytes_read=5101 bytes_retransmit=0 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999554 adj=49999746 Mini: temp=29.7  Pi: temp=48.2 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.22 cputime=5.644 memavail=1741332 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 40.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=31115 bytes_read=20404 bytes_retransmit=9 bytes_invalid=0 send_seq=1374 receive_seq=1374 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998446 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1090 bytes_read=5130 bytes_retransmit=0 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999543 adj=50000254 Mini: temp=29.9  Pi: temp=45.8 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.12 cputime=5.727 memavail=1741428 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 41.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=32277 bytes_read=20966 bytes_retransmit=9 bytes_invalid=0 send_seq=1421 receive_seq=1421 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=63998581 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1096 bytes_read=5146 bytes_retransmit=0 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999554 adj=49999512 Mini: temp=29.9  Pi: temp=42.7 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.12 cputime=5.842 memavail=1742688 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 42.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=33472 bytes_read=21585 bytes_retransmit=9 bytes_invalid=0 send_seq=1469 receive_seq=1469 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998641 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1102 bytes_read=5162 bytes_retransmit=0 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999576 adj=49999187 Mini: temp=29.7  Pi: temp=42.4 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=2.12 cputime=5.952 memavail=1742688 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.3 pwm=0.000
Stats 43.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=34660 bytes_read=22165 bytes_retransmit=9 bytes_invalid=0 send_seq=1518 receive_seq=1518 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998440 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1114 bytes_read=5194 bytes_retransmit=0 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999626 adj=49999388 Mini: temp=30.0  Pi: temp=42.5 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.12 cputime=6.070 memavail=1742688 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.4 pwm=0.000
Stats 44.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=35856 bytes_read=22740 bytes_retransmit=9 bytes_invalid=0 send_seq=1566 receive_seq=1566 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998524 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1120 bytes_read=5210 bytes_retransmit=0 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999631 adj=50000986 Mini: temp=30.1  Pi: temp=43.2 heater_bed: target=0 temp=24.3 pwm=0.000 sysload=2.12 cputime=6.156 memavail=1742428 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 45.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=37025 bytes_read=23363 bytes_retransmit=9 bytes_invalid=0 send_seq=1613 receive_seq=1613 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998498 pi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000016 bytes_write=1126 bytes_read=5239 bytes_retransmit=0 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999622 adj=50000520 Mini: temp=30.1  Pi: temp=48.5 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.03 cputime=6.211 memavail=1743228 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 46.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=38215 bytes_read=23943 bytes_retransmit=9 bytes_invalid=0 send_seq=1662 receive_seq=1662 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998535 pi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000016 bytes_write=1132 bytes_read=5255 bytes_retransmit=0 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999622 adj=50000690 Mini: temp=30.2  Pi: temp=45.3 heater_bed: target=0 temp=23.9 pwm=0.000 sysload=2.03 cputime=6.315 memavail=1743228 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.3 pwm=0.000
Stats 47.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=39419 bytes_read=24510 bytes_retransmit=9 bytes_invalid=0 send_seq=1711 receive_seq=1710 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998593 pi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000016 bytes_write=1138 bytes_read=5271 bytes_retransmit=0 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999631 adj=50000497 Mini: temp=29.9  Pi: temp=42.3 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.03 cputime=6.425 memavail=1743228 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.5 pwm=0.000
Stats 48.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=40568 bytes_read=25124 bytes_retransmit=9 bytes_invalid=0 send_seq=1757 receive_seq=1757 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998648 pi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000016 bytes_write=1144 bytes_read=5287 bytes_retransmit=0 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999645 adj=50000280 Mini: temp=30.3  Pi: temp=42.1 heater_bed: target=0 temp=24.4 pwm=0.000 sysload=2.03 cputime=6.538 memavail=1743228 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 49.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000134 bytes_write=41776 bytes_read=25704 bytes_retransmit=9 bytes_invalid=0 send_seq=1806 receive_seq=1806 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998593 pi: mcu_awake=0.001 mcu_task_avg=0.000010 mcu_task_stddev=0.000016 bytes_write=1150 bytes_read=5303 bytes_retransmit=0 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999649 adj=50000167 Mini: temp=30.1  Pi: temp=41.9 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=2.03 cputime=6.641 memavail=1742112 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.4 pwm=0.000
Stats 50.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=42976 bytes_read=26301 bytes_retransmit=9 bytes_invalid=0 send_seq=1855 receive_seq=1855 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998559 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1156 bytes_read=5332 bytes_retransmit=0 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999659 adj=50000673 Mini: temp=30.2  Pi: temp=47.4 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.03 cputime=6.722 memavail=1740608 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.1 pwm=0.000
Stats 51.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=44111 bytes_read=26897 bytes_retransmit=9 bytes_invalid=0 send_seq=1900 receive_seq=1900 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998501 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1162 bytes_read=5348 bytes_retransmit=0 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999653 adj=50000998 Mini: temp=30.3  Pi: temp=48.6 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.03 cputime=6.789 memavail=1742888 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Stats 52.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=45331 bytes_read=27477 bytes_retransmit=9 bytes_invalid=0 send_seq=1949 receive_seq=1949 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998487 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1168 bytes_read=5364 bytes_retransmit=0 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999650 adj=50001299 Mini: temp=30.3  Pi: temp=45.1 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.03 cputime=6.846 memavail=1742888 print_time=21.873 buffer_time=0.000 print_stall=0 extruder: target=0 temp=24.2 pwm=0.000
Heater extruder approaching new target of 240.000
Stats 53.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=46517 bytes_read=28057 bytes_retransmit=9 bytes_invalid=0 send_seq=1998 receive_seq=1998 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998463 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1190 bytes_read=5385 bytes_retransmit=0 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999656 adj=50001249 Mini: temp=30.2  Pi: temp=44.8 heater_bed: target=0 temp=24.6 pwm=0.000 sysload=2.03 cputime=6.944 memavail=1742888 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=24.5 pwm=1.000
Stats 54.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=47713 bytes_read=28663 bytes_retransmit=9 bytes_invalid=0 send_seq=2046 receive_seq=2045 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998440 pi: mcu_awake=0.000 mcu_task_avg=0.000008 mcu_task_stddev=0.000011 bytes_write=1196 bytes_read=5401 bytes_retransmit=0 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999673 adj=50001354 Mini: temp=30.4  Pi: temp=42.7 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=2.03 cputime=7.069 memavail=1742888 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=25.8 pwm=1.000
Stats 55.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=48879 bytes_read=29255 bytes_retransmit=9 bytes_invalid=0 send_seq=2093 receive_seq=2093 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998336 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000012 bytes_write=1202 bytes_read=5430 bytes_retransmit=0 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999681 adj=50001542 Mini: temp=30.2  Pi: temp=43.1 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=1.94 cputime=7.189 memavail=1743664 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=28.7 pwm=1.000
Stats 56.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=50075 bytes_read=29835 bytes_retransmit=9 bytes_invalid=0 send_seq=2142 receive_seq=2142 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998431 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000012 bytes_write=1208 bytes_read=5446 bytes_retransmit=0 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999688 adj=50002165 Mini: temp=30.4  Pi: temp=42.2 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=1.94 cputime=7.299 memavail=1742424 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=32.1 pwm=1.000
Stats 57.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=51264 bytes_read=30444 bytes_retransmit=9 bytes_invalid=0 send_seq=2188 receive_seq=2188 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998423 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000012 bytes_write=1230 bytes_read=5467 bytes_retransmit=0 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999687 adj=50001257 Mini: temp=30.3  Pi: temp=49.2 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=1.94 cputime=7.381 memavail=1743200 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=37.3 pwm=1.000
Stats 58.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=52435 bytes_read=31006 bytes_retransmit=9 bytes_invalid=0 send_seq=2236 receive_seq=2235 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=23 upcoming_bytes=0 freq=63998426 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000012 bytes_write=1236 bytes_read=5483 bytes_retransmit=0 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999682 adj=50001219 Mini: temp=30.5  Pi: temp=46.1 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=1.94 cputime=7.436 memavail=1743200 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=41.4 pwm=1.000
Stats 59.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000066 mcu_task_stddev=0.000135 bytes_write=53626 bytes_read=31586 bytes_retransmit=9 bytes_invalid=0 send_seq=2284 receive_seq=2284 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998427 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000012 bytes_write=1242 bytes_read=5499 bytes_retransmit=0 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999681 adj=50001104 Mini: temp=30.4  Pi: temp=45.3 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=1.94 cputime=7.491 memavail=1743200 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=45.3 pwm=1.000
Stats 60.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000067 mcu_task_stddev=0.000135 bytes_write=54815 bytes_read=32222 bytes_retransmit=9 bytes_invalid=0 send_seq=2332 receive_seq=2332 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998397 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=5528 bytes_retransmit=0 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999690 adj=50001026 Mini: temp=30.6  Pi: temp=45.8 heater_bed: target=0 temp=23.9 pwm=0.000 sysload=1.87 cputime=7.586 memavail=1743200 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=50.5 pwm=1.000
Stats 61.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000067 mcu_task_stddev=0.000135 bytes_write=55993 bytes_read=32793 bytes_retransmit=9 bytes_invalid=0 send_seq=2381 receive_seq=2381 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=63998395 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1270 bytes_read=5549 bytes_retransmit=0 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999696 adj=50001315 Mini: temp=30.5  Pi: temp=43.2 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=1.87 cputime=7.718 memavail=1743200 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=54.2 pwm=1.000
Stats 62.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000067 mcu_task_stddev=0.000135 bytes_write=57190 bytes_read=33356 bytes_retransmit=9 bytes_invalid=0 send_seq=2429 receive_seq=2429 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998444 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1276 bytes_read=5565 bytes_retransmit=0 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999701 adj=50001294 Mini: temp=30.6  Pi: temp=42.4 heater_bed: target=0 temp=24.2 pwm=0.000 sysload=1.87 cputime=7.841 memavail=1742444 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=57.9 pwm=1.000
Stats 63.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000067 mcu_task_stddev=0.000135 bytes_write=58399 bytes_read=34014 bytes_retransmit=9 bytes_invalid=0 send_seq=2481 receive_seq=2481 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998535 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1282 bytes_read=5581 bytes_retransmit=0 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999707 adj=50000876 Mini: temp=30.8  Pi: temp=45.0 heater_bed: target=0 temp=23.8 pwm=0.000 sysload=1.87 cputime=7.931 memavail=1742432 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=62.8 pwm=1.000
Stats 64.6: gcodein=0  mcu: mcu_awake=0.061 mcu_task_avg=0.000067 mcu_task_stddev=0.000135 bytes_write=59624 bytes_read=34623 bytes_retransmit=9 bytes_invalid=0 send_seq=2533 receive_seq=2533 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=63998509 pi: mcu_awake=0.000 mcu_task_avg=0.000007 mcu_task_stddev=0.000009 bytes_write=1288 bytes_read=5597 bytes_retransmit=0 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999709 adj=50000238 Mini: temp=30.5  Pi: temp=47.8 heater_bed: target=0 temp=24.1 pwm=0.000 sysload=1.87 cputime=7.989 memavail=1742460 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=66.3 pwm=1.000
Stats 65.6: gcodein=0  mcu: mcu_awake=0.062 mcu_task_avg=0.000065 mcu_task_stddev=0.000133 bytes_write=60850 bytes_read=35281 bytes_retransmit=9 bytes_invalid=0 send_seq=2587 receive_seq=2587 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=63998562 pi: mcu_awake=0.000 mcu_task_avg=0.000009 mcu_task_stddev=0.000011 bytes_write=1310 bytes_read=5631 bytes_retransmit=0 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49999706 adj=50000617 Mini: temp=30.6  Pi: temp=45.4 heater_bed: target=0 temp=24.0 pwm=0.000 sysload=1.80 cputime=8.050 memavail=1743496 print_time=57.981 buffer_time=0.000 print_stall=0 extruder: target=240 temp=69.6 pwm=1.000
Starting Klippy...
Args: ['/home/kkobold/klipper/klippy/klippy.py', '/home/kkobold/printer_data/config/printer.cfg', '-I', '/home/kkobold/printer_data/comms/klippy.serial', '-l', '/home/kkobold/printer_data/logs/klippy.log', '-a', '/home/kkobold/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-267-g12cd1d9e-dirty'
Untracked files: klippy/extras/led_effect.py
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper
CPU: 4 core ?
Python: '3.9.2 (default, Feb 28 2021, 17:03:44) \n[GCC 10.2.1 20210110]'
Start printer at Mon Aug  5 21:17:08 2024 (1722903428.7 12.6)
===== Config file =====
[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 3000
max_z_velocity = 5
max_z_accel = 100

[mcu]
serial = /dev/serial/by-id/usb-Klipper_stm32g0b1xx_26001E0001504B5735313920-if00
restart_method = command

[temperature_sensor SKR Mini]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[force_move]
enable_force_move = True

[exclude_object]

[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[mcu pi]
serial = /tmp/klipper_host_mcu

[temperature_sensor Pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[output_pin beeper]
pin = pi:gpiochip1/gpio118
value = 0
shutdown_value = 0
pwm = True
cycle_time = 0.0005

[stepper_x]
step_pin = PB13
dir_pin = !PB12
enable_pin = !PB14
microsteps = 16
rotation_distance = 40
position_endstop = -17
position_max = 235
homing_speed = 40
endstop_pin = tmc2209_stepper_x:virtual_endstop
homing_retract_dist = 0
position_min = -17

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
run_current = 0.580
diag_pin = PC0
driver_sgthrs = 80
interpolate = False
stealthchop_threshold = 999999

[stepper_y]
step_pin = PB10
dir_pin = !PB2
enable_pin = !PB11
microsteps = 16
rotation_distance = 40
position_endstop = -23
position_max = 227
position_min = -26
homing_speed = 40
endstop_pin = tmc2209_stepper_y:virtual_endstop
homing_retract_dist = 0

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
run_current = 0.580
interpolate = False
stealthchop_threshold = 999999
diag_pin = PC1
driver_sgthrs = 80

[stepper_z]
step_pin = PB0
dir_pin = PC5
enable_pin = !PB1
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 235
position_min = -8

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
run_current = 0.580
interpolate = False
stealthchop_threshold = 999999

[heater_bed]
heater_pin = pi:gpio3
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
control = pid
pid_kp = 70.901
pid_ki = 1.320
pid_kd = 951.845
min_temp = 0
max_temp = 130

[probe]
pin = PC2
x_offset = 40
y_offset = 18
speed = 5.0
lift_speed = 15.0
sample_retract_dist = 1
samples = 2
samples_tolerance_retries = 6
z_offset = 7.589

[screws_tilt_adjust]
screw1 = 10,-14
screw1_name = front left screw
screw2 = 10, 157
screw2_name = rear left screw
screw3 = 182, 157
screw3_name = rear right screw
screw4 = 182, -14
screw4_name = front right screw
screw_thread = CW-M4
horizontal_move_z = 9

[bed_mesh]
speed = 300
horizontal_move_z = 9
mesh_min = 10,-14
mesh_max = 167,167
probe_count = 5,5
zero_reference_position = 117.5, 117.5
algorithm = bicubic
fade_start = 1
fade_end = 10
split_delta_z = 0.015
move_check_distance = 3
mesh_pps = 4,4

[homing_override]
set_position_z = 0
gcode = 
	{% set PO = (params.PO|default(1)) %}
	{% set PI = (params.PI|default(1)) %}
	
	STATUS_HOMING
	G90
	G1 Z10 F3000
	G28 X
	G28 Y
	{% if PO == 1 %}
	PROBE_OUT
	{% endif %}
	G90
	G1 X99 Y77 F6000
	G28 Z
	G1 Z15
	
	
	
	
	
	
	{% if PI == 1 %}
	PROBE_IN
	{% endif %}
	STATUS_READY

[gcode_macro PROBE_OUT]
gcode = 
	G90
	G1 X228 F4000
	G4 P300
	G1 Z20
	G1 X0

[gcode_macro PROBE_IN]
gcode = 
	G90
	G1 Z20
	G1 X228 F20000
	G1 Y-8
	G1 Z5
	G4 P300
	G1 X220 F6000
	G1 Z15
	G1 X0

[gcode_macro BED_MESH_CALIBRATE]
rename_existing = _BED_MESH_CALIBRATE
gcode = 
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set bed_mesh_min = printer.configfile.settings.bed_mesh.mesh_min %}
	{% set bed_mesh_max = printer.configfile.settings.bed_mesh.mesh_max %}
	{% set probe_count = printer.configfile.settings.bed_mesh.probe_count %}
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set probe_dock_enable = kamp_settings.probe_dock_enable | abs %}
	{% set attach_macro = kamp_settings.attach_macro | string %}
	{% set detach_macro = kamp_settings.detach_macro | string %}
	{% set mesh_margin = kamp_settings.mesh_margin | float %}
	{% set fuzz_amount = kamp_settings.fuzz_amount | float %}
	{% set probe_count = probe_count if probe_count|length > 1 else probe_count * 2  %}
	{% set max_probe_point_distance_x = ( bed_mesh_max[0] - bed_mesh_min[0] ) / (probe_count[0] - 1)  %}
	{% set max_probe_point_distance_y = ( bed_mesh_max[1] - bed_mesh_min[1] ) / (probe_count[1] - 1)  %}
	{% set x_min = all_points | map(attribute=0) | min | default(bed_mesh_min[0]) %}
	{% set y_min = all_points | map(attribute=1) | min | default(bed_mesh_min[1]) %}
	{% set x_max = all_points | map(attribute=0) | max | default(bed_mesh_max[0]) %}
	{% set y_max = all_points | map(attribute=1) | max | default(bed_mesh_max[1]) %}
	
	{% set fuzz_range = range((0) | int, (fuzz_amount * 100) | int + 1) %}
	{% set adapted_x_min = x_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_y_min = y_min - mesh_margin - (fuzz_range | random / 100.0) %}
	{% set adapted_x_max = x_max + mesh_margin + (fuzz_range | random / 100.0) %}
	{% set adapted_y_max = y_max + mesh_margin + (fuzz_range | random / 100.0) %}
	
	{% set adapted_x_min = [adapted_x_min , bed_mesh_min[0]] | max %}
	{% set adapted_y_min = [adapted_y_min , bed_mesh_min[1]] | max %}
	{% set adapted_x_max = [adapted_x_max , bed_mesh_max[0]] | min %}
	{% set adapted_y_max = [adapted_y_max , bed_mesh_max[1]] | min %}
	
	{% set points_x = (((adapted_x_max - adapted_x_min) / max_probe_point_distance_x) | round(method='ceil') | int) + 1 %}
	{% set points_y = (((adapted_y_max - adapted_y_min) / max_probe_point_distance_y) | round(method='ceil') | int) + 1 %}
	
	{% if (([points_x, points_y]|max) > 6) %}
	{% set algorithm = "bicubic" %}
	{% set min_points = 4 %}
	{% else %}
	{% set algorithm = "lagrange" %}
	{% set min_points = 3 %}
	{% endif %}
	
	{% set points_x = [points_x , min_points]|max %}
	{% set points_y = [points_y , min_points]|max %}
	{% set points_x = [points_x , probe_count[0]]|min %}
	{% set points_y = [points_y , probe_count[1]]|min %}
	
	{% if verbose_enable == True %}
	{% if printer.exclude_object.objects != [] %}
	
	{ action_respond_info( "Algorithm: {}.".format(
	(algorithm),
	)) }
	
	{ action_respond_info("Default probe count: {},{}.".format(
	(probe_count[0]),
	(probe_count[1]),
	)) }
	
	{ action_respond_info("Adapted probe count: {},{}.".format(
	(points_x),
	(points_y),
	)) }
	
	{action_respond_info("Default mesh bounds: {}, {}.".format(
	(bed_mesh_min[0],bed_mesh_min[1]),
	(bed_mesh_max[0],bed_mesh_max[1]),
	)) }
	
	{% if mesh_margin > 0 %}
	{action_respond_info("Mesh margin is {}, mesh bounds extended by {}mm.".format(
	(mesh_margin),
	(mesh_margin),
	)) }
	{% else %}
	{action_respond_info("Mesh margin is 0, margin not increased.")}
	{% endif %}
	
	{% if fuzz_amount > 0 %}
	{action_respond_info("Mesh point fuzzing enabled, points fuzzed up to {}mm.".format(
	(fuzz_amount),
	)) }
	{% else %}
	{action_respond_info("Fuzz amount is 0, mesh points not fuzzed.")}
	{% endif %}
	
	{ action_respond_info("Adapted mesh bounds: {}, {}.".format(
	(adapted_x_min, adapted_y_min),
	(adapted_x_max, adapted_y_max),
	)) }
	
	{action_respond_info("KAMP adjustments successful. Happy KAMPing!")}
	
	{% else %}
	
	{action_respond_info("No objects detected! Check your gcode and make sure that EXCLUDE_OBJECT_DEFINE is happening before BED_MESH_CALIBRATE is called. Defaulting to regular meshing.")}
	G4 P5000
	{% endif %}
	
	{% endif %}
	
	{% if probe_dock_enable == True %}
	{attach_macro}
	{% endif %}
	
	_BED_MESH_CALIBRATE mesh_min={adapted_x_min},{adapted_y_min} mesh_max={adapted_x_max},{adapted_y_max} ALGORITHM={algorithm} PROBE_COUNT={points_x},{points_y}
	
	{% if probe_dock_enable == True %}
	{detach_macro}
	{% endif %}

[gcode_macro G29]
gcode = 
	PROBE_OUT
	BED_MESH_CALIBRATE
	
	PROBE_IN

[gcode_macro PROBE_CALIBRATE]
rename_existing = _PROBE_CALIBRATE
gcode = 
	{% if not 'xyz' in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	PROBE_OUT
	G90
	G1 Z20
	G1 X115 Y115 F20000
	_PROBE_CALIBRATE
	TESTZ Z=20
	M117 Remove the Klack to continue calibration!

[gcode_macro PROBE_ACCURACY]
rename_existing = _PROBE_ACCURACY
gcode = 
	{% if not 'xyz' in printer.toolhead.homed_axes %}
	G28
	{% endif %}
	PROBE_OUT
	G90
	G1 Y115 X115 F20000
	_PROBE_ACCURACY
	PROBE_IN

[gcode_macro SCREWS_TILT_CALCULATE]
rename_existing = _SCREWS_TILT_CALCULATE
gcode = 
	{% set PO = (params.PO|default(1)) %}
	{% set PI = (params.PI|default(1)) %}
	{% if PO == 1 %}
	PROBE_OUT
	{% endif %}
	_SCREWS_TILT_CALCULATE
	{% if PI == 1 %}
	PROBE_IN
	{% endif %}
	G1 X117.5 Y220 Z20 F25000
	BEEP DUR=1000

[extruder]
max_extrude_only_distance = 750
step_pin = PB3
dir_pin = PB4
enable_pin = !PD1
gear_ratio = 50:10
microsteps = 16
full_steps_per_rotation = 200
rotation_distance = 22.6789511
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = pi:gpio2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA0
pressure_advance = 0.418
min_temp = 0
max_temp = 300
min_extrude_temp = 0
control = pid
pid_kp = 38.039
pid_ki = 4.528
pid_kd = 79.882

[tmc2209 extruder]
uart_pin = PC11
tx_pin = PC10
uart_address = 3
interpolate = False
stealthchop_threshold = 0
run_current = 0.54
hold_current = 0.44

[neopixel sb_leds]
pin = PA8
chain_count = 10
color_order = GRB, GRB, GRB, GRB, GRB, GRB, GRB, GRB, GRBW,  GRBW
initial_red = 1.0
initial_green = 0.0
initial_blue = 1.0
initial_white = 0.0

[led_effect sb_logo_busy]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (1,0,0)

[led_effect sb_logo_cleaning]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.02, 0.5)

[led_effect sb_logo_calibrating_z]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.0, 0.35)

[led_effect sb_logo_heating]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (1, 0.18, 0)

[led_effect sb_logo_cooling]
leds = 
	neopixel:sb_leds (1,3,7,8,6,2)
autostart = false
frame_rate = 24
layers = 
	comet  0.3  0 add (0, 0, 1)

[led_effect sb_logo_homing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 0.6, 0.2)

[led_effect sb_logo_leveling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.5, 0.1, 0.4)

[led_effect sb_logo_meshing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.2, 1.0, 0.0)

[led_effect sb_logo_printing]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.3, 0.3, 0.0),(0.3, 0.1, 0.0)

[led_effect sb_logo_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.01, 0.01, 0.01)

[led_effect sb_logo_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (1-8)
layers = 
	breathing  3 1 top (0.0, 1.0, 0.0)

[led_effect sb_nozzle_heating]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (1.0, 0.18, 0.0, 0.0)

[led_effect sb_nozzle_cooling]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.0, 0.0, 1.0, 0.1)

[led_effect sb_nozzle_standby]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 0.0, 0.0, 0.0)

[led_effect sb_nozzle_part_ready]
autostart = false
frame_rate = 24
leds = 
	neopixel:sb_leds (9,10)
layers = 
	breathing  3 1 top (0.6, 1.0, 0.0, 0.1)

[led_effect sb_critical_error]
leds = 
	neopixel:sb_leds
layers = 
	strobe         1  1.5   add        (1.0,  1.0, 1.0)
	breathing      2  0     difference (0.95, 0.0, 0.0)
	static         1  0     top        (1.0,  0.0, 0.0)
autostart = false
frame_rate = 24
run_on_error = true

[led_effect rainbow]
leds = 
	neopixel:sb_leds
autostart = true
frame_rate = 24
layers = 
	gradient  0.3  1 add (0.3, 0.0, 0.0),(0.0, 0.3, 0.0),(0.0, 0.0, 0.3)

[led_effect set_nozzle_leds]
leds = 
	neopixel:sb_leds (9,10)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (0.0,  0.0, 0.0, 1.0)

[led_effect set_logo_leds]
leds = 
	neopixel:sb_leds (1,2,3,4,5,6,7,8)
autostart = false
frame_rate = 24
layers = 
	static         0  0     top        (1.0,  1.0, 1.0)

[gcode_macro set_logo_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds STOP=1

[gcode_macro set_logo_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_logo_leds

[gcode_macro set_nozzle_leds_on]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds

[gcode_macro set_nozzle_leds_off]
gcode = 
	SET_LED_EFFECT EFFECT=set_nozzle_leds STOP=1

[gcode_macro status_off]
gcode = 
	STOP_LED_EFFECTS

[gcode_macro status_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=rainbow

[gcode_macro status_part_ready]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_nozzle_part_ready
	SET_LED_EFFECT EFFECT=sb_logo_part_ready

[gcode_macro status_busy]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_busy
	set_nozzle_leds_on

[gcode_macro status_heating]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_heating
	SET_LED_EFFECT EFFECT=sb_nozzle_heating

[gcode_macro status_cooling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cooling
	SET_LED_EFFECT EFFECT=sb_nozzle_cooling

[gcode_macro status_leveling]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_leveling
	set_nozzle_leds_on

[gcode_macro status_homing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_homing
	set_nozzle_leds_on

[gcode_macro status_cleaning]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_cleaning
	set_nozzle_leds_on

[gcode_macro status_meshing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_meshing
	set_nozzle_leds_on

[gcode_macro status_calibrating_z]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_calibrating_z
	set_nozzle_leds_on

[gcode_macro status_printing]
gcode = 
	STOP_LED_EFFECTS
	SET_LED_EFFECT EFFECT=sb_logo_printing
	set_nozzle_leds_on

[pause_resume]

[display_status]

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set allow_park = client.park_at_cancel | default(false) | lower == 'true' %}
	{% set retract = client.cancel_retract | default(5.0) | abs %}
	
	{% set park_x = "" if (client.park_at_cancel_x | default(none) is none)
	else "X=" ~ client.park_at_cancel_x %}
	{% set park_y = "" if (client.park_at_cancel_y | default(none) is none)
	else "Y=" ~ client.park_at_cancel_y %}
	{% set custom_park = park_x | length > 0 or park_y | length > 0 %}
	
	
	{% if printer['gcode_macro RESUME'].restore_idle_timeout > 0 %}
	SET_IDLE_TIMEOUT TIMEOUT={printer['gcode_macro RESUME'].restore_idle_timeout}
	{% endif %}
	{% if (custom_park or not printer.pause_resume.is_paused) and allow_park %} _TOOLHEAD_PARK_PAUSE_CANCEL {park_x} {park_y} {% endif %}
	_CLIENT_RETRACT LENGTH={retract}
	TURN_OFF_HEATERS
	M106 S0
	{client.user_cancel_macro | default("")}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	
	SET_PAUSE_NEXT_LAYER ENABLE=0
	SET_PAUSE_AT_LAYER ENABLE=0 LAYER=0
	CANCEL_PRINT_BASE

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set idle_timeout = client.idle_timeout | default(0) %}
	{% set temp = printer[printer.toolhead.extruder].target if printer.toolhead.extruder != '' else 0 %}
	{% set restore = False if printer.toolhead.extruder == ''
	else True  if params.RESTORE | default(1) | int == 1 else False %}
	
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=last_extruder_temp VALUE="{{'restore': restore, 'temp': temp}}"
	
	{% if idle_timeout > 0 %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=restore_idle_timeout VALUE={printer.configfile.settings.idle_timeout.timeout}
	SET_IDLE_TIMEOUT TIMEOUT={idle_timeout}
	{% endif %}
	PAUSE_BASE
	{client.user_pause_macro | default("")}
	_TOOLHEAD_PARK_PAUSE_CANCEL {rawparams}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set sp_move = client.speed_move | default(velocity) %}
	{% set runout_resume = True if client.runout_sensor | default("") == ""
	else True if not printer[client.runout_sensor].enabled
	else printer[client.runout_sensor].filament_detected %}
	{% set can_extrude = True if printer.toolhead.extruder == ''
	else printer[printer.toolhead.extruder].can_extrude %}
	{% set do_resume = False %}
	{% set prompt_txt = [] %}
	
	
	{% if printer.idle_timeout.state | upper == "IDLE" or idle_state %}
	SET_GCODE_VARIABLE MACRO=RESUME VARIABLE=idle_state VALUE=False
	{% if last_extruder_temp.restore %}
	
	RESPOND TYPE=echo MSG='{"Restoring \"%s\" temperature to %3.1f\u00B0C, this may take some time" % (printer.toolhead.extruder, last_extruder_temp.temp) }'
	M109 S{last_extruder_temp.temp}
	{% set do_resume = True %}
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	
	{% elif can_extrude %}
	{% set do_resume = True %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder}'
	{% set _d = prompt_txt.append("\"%s\" not hot enough, please heat up again and press RESUME" % printer.toolhead.extruder) %}
	{% endif %}
	{% if runout_resume %}
	{% if do_resume %}
	{% if restore_idle_timeout > 0 %} SET_IDLE_TIMEOUT TIMEOUT={restore_idle_timeout} {% endif %}
	{client.user_resume_macro | default("")}
	_CLIENT_EXTRUDE
	RESUME_BASE VELOCITY={params.VELOCITY | default(sp_move)}
	{% endif %}
	{% else %}
	RESPOND TYPE=error MSG='{"Resume aborted !!! \"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]}'
	{% set _d = prompt_txt.append("\"%s\" detects no filament, please load filament and press RESUME" % (client.runout_sensor.split(" "))[1]) %}
	{% endif %}
	
	{% if not (runout_resume and do_resume) %}
	RESPOND TYPE=command MSG="action:prompt_begin RESUME aborted !!!"
	{% for element in prompt_txt %}
	RESPOND TYPE=command MSG='{"action:prompt_text %s" % element}'
	{% endfor %}
	RESPOND TYPE=command MSG="action:prompt_footer_button Ok|RESPOND TYPE=command MSG=action:prompt_end|info"
	RESPOND TYPE=command MSG="action:prompt_show"
	{% endif %}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE | default(1)|int != 0 %}
	{% set MACRO = params.MACRO | default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE | int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER | default(pause_at_layer.layer) | int %}
	{% set MACRO = params.MACRO | default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER | int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos | default(false) | lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x | default(0.0) %}
	{% set custom_park_y  = client.custom_park_y | default(0.0) %}
	{% set park_dz        = client.custom_park_dz | default(2.0) | abs %}
	{% set sp_hop         = client.speed_hop | default(15) * 60 %}
	{% set sp_move        = client.speed_move | default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z | default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN | default(0) | float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)] | min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set use_fw_retract = (client.use_fw_retract | default(false) | lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH | default(client.unretract) | default(1.0) | float %}
	{% set speed = params.SPEED | default(client.speed_unretract) | default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed | float | abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE'] | default({}) %}
	{% set length = params.LENGTH | default(client.retract) | default(1.0) | float %}
	{% set speed = params.SPEED | default(client.speed_retract) | default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length | float | abs} SPEED={speed | float | abs}

[gcode_macro LINE_PURGE]
description = A purge macro that adapts to be near your actual printed objects
gcode = 
	
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	{% set cross_section = printer.configfile.settings.extruder.max_extrude_cross_section | float %}
	
	
	{% if printer.firmware_retraction is defined %}
	{% set RETRACT = G10 | string %}
	{% set UNRETRACT = G11 | string %}
	{% else %}
	{% set RETRACT = 'G1 E-.5 F2100' | string %}
	{% set UNRETRACT = 'G1 E.5 F2100' | string %}
	{% endif %}
	
	
	{% set verbose_enable = printer["gcode_macro _KAMP_Settings"].verbose_enable | abs %}
	{% set purge_height = printer["gcode_macro _KAMP_Settings"].purge_height | float %}
	{% set tip_distance = printer["gcode_macro _KAMP_Settings"].tip_distance | float %}
	{% set purge_margin = printer["gcode_macro _KAMP_Settings"].purge_margin | float %}
	{% set purge_amount = printer["gcode_macro _KAMP_Settings"].purge_amount | float %}
	{% set flow_rate = printer["gcode_macro _KAMP_Settings"].flow_rate | float %}
	
	
	
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set purge_x_min = (all_points | map(attribute=0) | min | default(0)) %}
	{% set purge_x_max = (all_points | map(attribute=0) | max | default(0)) %}
	{% set purge_y_min = (all_points | map(attribute=1) | min | default(0)) %}
	{% set purge_y_max = (all_points | map(attribute=1) | max | default(0)) %}
	
	{% set purge_x_center = ([((purge_x_max + purge_x_min) / 2) - (purge_amount / 2), 0] | max) %}
	{% set purge_y_center = ([((purge_y_max + purge_y_min) / 2) - (purge_amount / 2), 0] | max) %}
	
	{% set purge_x_origin = ([purge_x_min - purge_margin, 0] | max) %}
	{% set purge_y_origin = ([purge_y_min - purge_margin, 0] | max) %}
	
	
	{% set purge_move_speed = (flow_rate / 5.0) * 60 | float %}
	
	{% if cross_section < 5 %}
	
	{action_respond_info("[Extruder] max_extrude_cross_section is insufficient for purge, please set it to 5 or greater. Purge skipped.")}
	
	{% else %}
	
	{% if verbose_enable == True %}
	
	{action_respond_info("Moving filament tip {}mms".format(
	(tip_distance),
	)) }
	{% endif %}
	
	{% if printer.firmware_retraction is defined %}
	{action_respond_info("KAMP purge is using firmware retraction.")}
	{% else %}
	{action_respond_info("KAMP purge is not using firmware retraction, it is recommended to configure it.")}
	{% endif %}
	
	{% if purge_y_origin > 0 %}
	
	{action_respond_info("KAMP purge starting at {}, {} and purging {}mm of filament, requested flow rate is {}mm3/s.".format(
	(purge_x_center),
	(purge_y_origin),
	(purge_amount),
	(flow_rate),
	)) }
	
	{% else %}
	
	{action_respond_info("KAMP purge starting at {}, {} and purging {}mm of filament, requested flow rate is {}mm3/s.".format(
	(purge_x_origin),
	(purge_y_center),
	(purge_amount),
	(flow_rate),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Prepurge_State
	
	{% if purge_y_origin > 0 %}
	
	G92 E0
	G0 F{travel_speed}
	G90
	G0 X{purge_x_center} Y{purge_y_origin}
	G0 Z{purge_height}
	M83
	G1 E{tip_distance} F{purge_move_speed}
	G1 X{purge_x_center + purge_amount} E{purge_amount} F{purge_move_speed}
	{RETRACT}
	G0 X{purge_x_center + purge_amount + 10} F{travel_speed}
	G92 E0
	M82
	G0 Z{purge_height * 2} F{travel_speed}
	
	{% else %}
	
	G92 E0
	G0 F{travel_speed}
	G90
	G0 X{purge_x_origin} Y{purge_y_center}
	G0 Z{purge_height}
	M83
	G1 E{tip_distance} F{purge_move_speed}
	G1 Y{purge_y_center + purge_amount} E{purge_amount} F{purge_move_speed}
	{RETRACT}
	G0 Y{purge_y_center + purge_amount + 10} F{travel_speed}
	G92 E0
	M82
	G0 Z{purge_height * 2} F{travel_speed}
	
	{% endif %}
	
	RESTORE_GCODE_STATE NAME=Prepurge_State
	
	{% endif %}

[gcode_macro SMART_PARK]
description = Parks your printhead near the print area for pre-print hotend heating.
gcode = 
	
	{% set kamp_settings = printer["gcode_macro _KAMP_Settings"] %}
	{% set z_height = kamp_settings.smart_park_height | float %}
	{% set purge_margin = kamp_settings.purge_margin | float %}
	{% set verbose_enable = kamp_settings.verbose_enable | abs %}
	{% set center_x = printer.toolhead.axis_maximum.x / 2 | float %}
	{% set center_y = printer.toolhead.axis_maximum.y / 2 | float %}
	{% set axis_minimum_x = printer.toolhead.axis_minimum.x | float %}
	{% set axis_minimum_y = printer.toolhead.axis_minimum.y | float %}
	{% set all_points = printer.exclude_object.objects | map(attribute='polygon') | sum(start=[]) %}
	{% set x_min = all_points | map(attribute=0) | min | default(center_x) %}
	{% set y_min = all_points | map(attribute=1) | min | default(center_y) %}
	{% set travel_speed = (printer.toolhead.max_velocity) * 60 | float %}
	
	{% if purge_margin > 0 and x_min != center_x and y_min != center_y %}
	{% set x_min = [ x_min - purge_margin , x_min ] | min %}
	{% set y_min = [ y_min - purge_margin , y_min ] | min %}
	{% set x_min = [ x_min , axis_minimum_x ] | max %}
	{% set y_min = [ y_min , axis_minimum_y ] | max %}
	{% endif %}
	
	
	{% if verbose_enable == True %}
	
	{ action_respond_info("Smart Park location: {},{}.".format(
	(x_min),
	(y_min),
	)) }
	
	{% endif %}
	
	SAVE_GCODE_STATE NAME=Presmartpark_State
	
	G90
	{% if printer.toolhead.position.z < z_height %}
	G0 Z{z_height}
	{% endif %}
	G0 X{x_min} Y{y_min} F{travel_speed}
	G0 Z{z_height}
	
	RESTORE_GCODE_STATE NAME=Presmartpark_State

[gcode_macro _KAMP_Settings]
description = This macro contains all adjustable settings for KAMP
variable_verbose_enable = True
variable_mesh_margin = 0
variable_fuzz_amount = 0
variable_probe_dock_enable = True
variable_attach_macro = 'PROBE_OUT'
variable_detach_macro = 'PROBE_IN'
variable_purge_height = 0.3
variable_tip_distance = 0
variable_purge_margin = 10
variable_purge_amount = 30
variable_flow_rate = 5
variable_smart_park_height = 10
gcode = 
	
	{action_respond_info(" Running the KAMP_Settings macro does nothing, it is only used for storing KAMP settings. ")}

[gcode_macro PRINT_START]
gcode = 
	
	{% set target_bed = params.BED|int %}
	{% set target_extruder = params.EXTRUDER|int %}
	{% set target_chamber = params.CHAMBER|default("40")|int %}
	{% set x_wait = printer.toolhead.axis_maximum.x|float / 2 %}
	{% set y_wait = printer.toolhead.axis_maximum.y|float / 2 %}
	
	
	SET_DISPLAY_TEXT MSG="Homing..."
	M140 S{target_bed}
	M104 S{target_extruder}
	M300
	STATUS_HOMING
	_CG28
	G90
	
	
	BED_MESH_CLEAR
	
	
	
	SET_DISPLAY_TEXT MSG="Bed: {target_bed}c"
	STATUS_HEATING
	M106 S255
	
	
	
	
	G1 X{x_wait} Y{y_wait} Z15 F9000
	M300
	M300
	M190 S{target_bed}
	M300
	M300
	M300
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	SET_DISPLAY_TEXT MSG="Bed mesh"
	STATUS_MESHING
	bed_mesh_calibrate
	M300
	M300
	M300
	M300
	
	
	SET_DISPLAY_TEXT MSG="Hotend: {target_extruder}c"
	STATUS_HEATING
	G1 X{x_wait} Y{y_wait} Z15 F9000
	M107
	M109 S{target_extruder}
	
	SET_DISPLAY_TEXT MSG="Printing Prime Line"
	PRIME_LINE
	
	SET_DISPLAY_TEXT MSG="Printer goes brr"
	STATUS_PRINTING
	M300
	M300
	M300
	M300
	M300
	G0 X{x_wait - 50} Y4 F10000
	G0 Z0.4
	G91
	G1 X100 E20 F1000
	G90

[gcode_macro END_PRINT]
gcode = 
	
	SET_DISPLAY_TEXT MSG="Work Complete!"
	STATUS_PART_READY
	M140 S0
	M104 S0
	M106 S0
	G91
	G1 Z25 F3000
	G1 X10 Y200
	G90
	M84
	M300
	M300
	M300
	M300
	M300
	M300

[gcode_macro PRIME_LINE]
gcode = 
	STATUS_CLEANING
	G92 E0
	G1 X3.1 Y10 Z0.2 F5000.0
	G1 X3.1 Y200.0 Z0.2 F3000.0 E15
	G1 X3.5 Y200.0 Z0.2 F5000.0
	G1 X3.5 Y10 Z0.2 F3000.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 E-2 F300

[gcode_macro _CG28]
gcode = 
	{% if "xyz" not in printer.toolhead.homed_axes %}
	G28
	{% endif %}

[gcode_macro M109]
rename_existing = M99109
gcode = 
	
	{% set s = params.S|float %}
	
	M104 {% for p in params %}{'%s%s' % (p, params[p])}{% endfor %}
	{% if s != 0 %}
	TEMPERATURE_WAIT SENSOR=extruder MINIMUM={s} MAXIMUM={s+1}
	{% endif %}

[gcode_macro M190]
rename_existing = M99190
gcode = 
	
	{% set s = params.S|float %}
	
	M140 {% for p in params %}{'%s%s' % (p, params[p])}{% endfor %}
	{% if s != 0 %}
	TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={s} MAXIMUM={s+1}
	{% endif %}

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(2)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GANTRY_ALIGN]
gcode = 
	G28 PI=0
	G1 Z225
	M84
	G28 PO=0 PI=0
	Z_TILT_ADJUST PO=0 PI=0
	SCREWS_TILT_CALCULATE PO=0

[gcode_macro BEEP]
gcode = 
	
	{% set i = params.I|default(1)|int %}
	{% set dur = params.DUR|default(100)|int %}
	{% set freq = params.FREQ|default(2000)|int %}
	
	{% for iteration in range(i|int) %}
	SET_PIN PIN=beeper VALUE=0.8 CYCLE_TIME={ 1.0/freq if freq > 0 else 1 }
	G4 P{dur}
	SET_PIN PIN=beeper VALUE=0
	G4 P{dur}
	{% endfor %}

[gcode_macro M300]
gcode = 
	BEEP dur=100
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
Loaded MCU 'mcu' 106 commands (v0.12.0-85-gd785b396 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.34-4+rpi1+14) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1_PA9_PA10=PA9,PA10 BUS_PINS_i2c1_PB6_PB7=PB6,PB7 BUS_PINS_i2c1_PB8_PB9=PB8,PB9 BUS_PINS_i2c2_PB10_PB11=PB10,PB11 BUS_PINS_i2c2_PB13_PB14=PB13,PB14 BUS_PINS_i2c3_PB3_PB4=PB3,PB4 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=64000000 MCU=stm32g0b1xx PWM_MAX=255 RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PF0,PF1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'pi': Starting connect
webhooks client 281473317788208: New connection
Loaded MCU 'pi' 119 commands (v0.12.0-267-g12cd1d9e / gcc: (Debian 10.2.1-6) 10.2.1 20210110 binutils: (GNU Binutils for Debian) 2.35.2)
MCU 'pi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
mcu_temperature 'mcu' nominal base=-264.842407 slope=1290.687679
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Sending MCU 'pi' printer configuration...
Configured MCU 'pi' (1024 moves)
webhooks client 281473317788208: Client info {'program': 'Moonraker', 'version': 'v0.8.0-385-gdc00d38'}
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (-30.0, -32.0)  | (10.0, -14.0)
  1   | (9.2, -32.0)    | (49.2, -14.0)
  2   | (48.5, -32.0)   | (88.5, -14.0)
  3   | (87.8, -32.0)   | (127.8, -14.0)
  4   | (127.0, -32.0)  | (167.0, -14.0)
  5   | (127.0, 13.2)   | (167.0, 31.2)
  6   | (87.8, 13.2)    | (127.8, 31.2)
  7   | (48.5, 13.2)    | (88.5, 31.2)
  8   | (9.2, 13.2)     | (49.2, 31.2)
  9   | (-30.0, 13.2)   | (10.0, 31.2)
  10  | (-30.0, 58.5)   | (10.0, 76.5)
  11  | (9.2, 58.5)     | (49.2, 76.5)
  12  | (48.5, 58.5)    | (88.5, 76.5)
  13  | (87.8, 58.5)    | (127.8, 76.5)
  14  | (127.0, 58.5)   | (167.0, 76.5)
  15  | (127.0, 103.8)  | (167.0, 121.8)
  16  | (87.8, 103.8)   | (127.8, 121.8)
  17  | (48.5, 103.8)   | (88.5, 121.8)
  18  | (9.2, 103.8)    | (49.2, 121.8)
  19  | (-30.0, 103.8)  | (10.0, 121.8)
  20  | (-30.0, 149.0)  | (10.0, 167.0)
  21  | (9.2, 149.0)    | (49.2, 167.0)
  22  | (48.5, 149.0)   | (88.5, 167.0)
  23  | (87.8, 149.0)   | (127.8, 167.0)
  24  | (127.0, 149.0)  | (167.0, 167.0)
bed_mesh: zero_reference_position is (117.50, 117.50)
Starting heater checks for extruder
Stats 16.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=2533 bytes_read=5895 bytes_retransmit=9 bytes_invalid=0 send_seq=218 receive_seq=218 retransmit_seq=2 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=64008433 pi: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=946 bytes_read=4679 bytes_retransmit=0 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49983241 adj=49955363 Mini: temp=0.0  Pi: temp=53.8 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=2.33 cputime=3.816 memavail=1743600 print_time=21.868 buffer_time=0.199 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 281473317788208
webhooks: registering remote method 'reboot_machine' for connection id: 281473317788208
webhooks: registering remote method 'pause_job_queue' for connection id: 281473317788208
webhooks: registering remote method 'start_job_queue' for connection id: 281473317788208
Stats 17.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=3729 bytes_read=6426 bytes_retransmit=9 bytes_invalid=0 send_seq=266 receive_seq=266 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=64002374 pi: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=952 bytes_read=4695 bytes_retransmit=0 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49991764 adj=49985955 Mini: temp=30.2  Pi: temp=49.5 heater_bed: target=0 temp=25.1 pwm=0.000 sysload=2.33 cputime=3.908 memavail=1731740 print_time=21.868 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.3 pwm=0.000
Stats 18.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=5021 bytes_read=7173 bytes_retransmit=9 bytes_invalid=0 send_seq=325 receive_seq=325 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=64005522 pi: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=958 bytes_read=4711 bytes_retransmit=0 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49995332 adj=50004323 Mini: temp=30.3  Pi: temp=49.1 heater_bed: target=0 temp=25.0 pwm=0.000 sysload=2.33 cputime=4.003 memavail=1716380 print_time=21.868 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.2 pwm=0.000
Stats 19.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=6181 bytes_read=7789 bytes_retransmit=9 bytes_invalid=0 send_seq=375 receive_seq=375 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=64005489 pi: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=964 bytes_read=4727 bytes_retransmit=0 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49997166 adj=50002292 Mini: temp=30.4  Pi: temp=50.7 heater_bed: target=0 temp=25.1 pwm=0.000 sysload=2.33 cputime=4.091 memavail=1721844 print_time=21.868 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.2 pwm=0.000
Stats 20.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000041 mcu_task_stddev=0.000093 bytes_write=7380 bytes_read=8381 bytes_retransmit=9 bytes_invalid=0 send_seq=423 receive_seq=423 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=64004853 pi: mcu_awake=0.004 mcu_task_avg=0.000026 mcu_task_stddev=0.000024 bytes_write=970 bytes_read=4758 bytes_retransmit=0 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49997940 adj=50003125 Mini: temp=30.5  Pi: temp=51.6 heater_bed: target=0 temp=25.2 pwm=0.000 sysload=2.30 cputime=4.167 memavail=1741424 print_time=21.868 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.2 pwm=0.000
Stats 21.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000041 mcu_task_stddev=0.000093 bytes_write=8655 bytes_read=9120 bytes_retransmit=9 bytes_invalid=0 send_seq=482 receive_seq=482 retransmit_seq=2 srtt=0.001 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=64004763 pi: mcu_awake=0.004 mcu_task_avg=0.000026 mcu_task_stddev=0.000024 bytes_write=976 bytes_read=4774 bytes_retransmit=0 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49998130 adj=50003424 Mini: temp=30.6  Pi: temp=49.9 heater_bed: target=0 temp=25.0 pwm=0.000 sysload=2.30 cputime=4.247 memavail=1741424 print_time=21.868 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.1 pwm=0.000
Stats 22.7: gcodein=0  mcu: mcu_awake=0.057 mcu_task_avg=0.000041 mcu_task_stddev=0.000093 bytes_write=9834 bytes_read=9702 bytes_retransmit=9 bytes_invalid=0 send_seq=530 receive_seq=530 retransmit_seq=2 srtt=0.002 rttvar=0.000 rto=0.025 ready_bytes=22 upcoming_bytes=0 freq=64004253 pi: mcu_awake=0.004 mcu_task_avg=0.000026 mcu_task_stddev=0.000024 bytes_write=982 bytes_read=4790 bytes_retransmit=0 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=49998076 adj=50001757 Mini: temp=30.6  Pi: temp=48.6 heater_bed: target=0 temp=25.1 pwm=0.000 sysload=2.30 cputime=4.321 memavail=1739660 print_time=21.868 buffer_time=0.000 print_stall=0 extruder: target=0 temp=26.1 pwm=0.000
